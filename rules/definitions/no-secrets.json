{
  "version": "1.0",
  "id": "no-secrets",
  "type": "rule",
  "platforms": ["git", "claude", "all"],
  "compatibility": {
    "os": ["windows", "linux", "macos"],
    "shells": ["bash", "powershell", "cmd"],
    "requirements": ["git>=2.0"]
  },
  "metadata": {
    "name": "No Secrets in Code",
    "description": "Prevents committing sensitive information like API keys, passwords, and tokens",
    "category": "security",
    "severity": "critical",
    "tags": ["security", "secrets", "sensitive-data"],
    "enabled_by_default": true
  },
  "implementation": {
    "git": {
      "hooks": ["pre-commit"],
      "command": "git diff --cached --name-only -z | xargs -0 grep -l -E '(api[_-]?key|password|secret|token|private[_-]?key)\\s*[:=]\\s*[\"'\"'`][^\"'\"'`]+[\"'\"'`]' || exit 0",
      "files": ["**/*"]
    },
    "claude": {
      "hooks": ["pre-submit", "pre-file-edit"],
      "validator": "validateNoSecrets",
      "config": {
        "patterns": [
          "api[_-]?key\\s*[:=]",
          "password\\s*[:=]",
          "secret\\s*[:=]",
          "token\\s*[:=]",
          "private[_-]?key\\s*[:=]"
        ],
        "excludePatterns": ["*.test.js", "*.spec.js", "*.md"],
        "message": "Potential secret detected. Please remove sensitive information before proceeding."
      }
    },
    "windows": {
      "hooks": ["pre-commit"],
      "command": "powershell -Command \"git diff --cached --name-only | ForEach-Object { if (Select-String -Path $_ -Pattern '(api[_-]?key|password|secret|token|private[_-]?key)\\s*[:=]\\s*[\\\"'''`][^\\\"'''`]+[\\\"'''`]' -Quiet) { Write-Error 'Secrets detected in $_'; exit 1 } }\""
    }
  },
  "options": {
    "customPatterns": [],
    "allowedFiles": [".env.example", ".env.template"],
    "severity": "error"
  }
}